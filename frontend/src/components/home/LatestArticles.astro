---
let ArticleCard = null;
try {
  ArticleCard = await import("../ArticleCard.astro");
} catch {}

const { articles = [] } = Astro.props;
const items = Array.isArray(articles) ? articles.filter(a => a?.slug && a?.title).slice(0, 3) : [];
---
<section class="mb-12">
  <div class="flex items-end justify-between mb-6">
    <div>
      <p class="text-xs font-semibold uppercase tracking-widest mb-1.5" style="color:#1e88e5;">
        Blog
      </p>
      <h2 class="text-xl sm:text-2xl font-extrabold" style="color:#e5e5e5;">
        Guías y comparativas
      </h2>
      <p class="mt-1 text-sm" style="color:rgba(229,229,229,0.55);">
        Artículos para decidir mejor antes de comprar.
      </p>
    </div>
    <a href="/blog/" class="hidden sm:inline-flex text-sm font-semibold" style="color: rgba(229,229,229,0.55);">
      Ver blog →
    </a>
  </div>

  {items.length > 0 ? (
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
      {items.map((a) => (
        ArticleCard ? (
          <ArticleCard.default article={a} />
        ) : (
          <a
            href={`/blog/${a.slug}/`}
            class="rounded-3xl p-6 transition"
            style="background:#151a22;border:1px solid rgba(255,255,255,0.08);"
          >
            <p class="text-base font-semibold" style="color:#e5e5e5;">{a.title}</p>
            <p class="mt-2 text-sm" style="color:rgba(229,229,229,0.55);">
              {a.description ?? a.excerpt ?? ""}
            </p>
          </a>
        )
      ))}
    </div>
  ) : (
    <div class="rounded-3xl p-6" style="background: rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.08);">
      <p style="color: rgba(229,229,229,0.65);">Todavía no hay artículos.</p>
      <a href="/blog/" style="color:#3aa0ff;" class="underline underline-offset-4">Ir al blog</a>
    </div>
  )}
</section>
